{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-05-11T22:18:56.431847Z", "invocation_id": "f3407acd-8f02-470f-acb4-394cbd30f77b", "env": {}}, "results": [{"status": "error", "timing": [{"name": "compile", "started_at": "2025-05-11T22:18:54.705333Z", "completed_at": "2025-05-11T22:18:54.728425Z"}, {"name": "execute", "started_at": "2025-05-11T22:18:54.746386Z", "completed_at": "2025-05-11T22:18:54.803150Z"}], "thread_id": "Thread-2", "execution_time": 0.11275911331176758, "adapter_response": {}, "message": "Database Error in model student_avg_completion (models/staging/student_avg_completion.sql)\n  syntax error at or near \")\"\n  LINE 17:   );\n             ^\n  compiled code at target/run/my_dbt_project/models/staging/student_avg_completion.sql", "failures": null, "unique_id": "model.my_dbt_project.student_avg_completion", "compiled": true, "compiled_code": "-- WITH student_avg_completion AS (\n--     SELECT\n--         student_id,\n--         AVG(completion_rate_percent) AS avg_completion_rate\n--     FROM \"analytics\".\"public\".\"lms_engagement_data\"\n--     WHERE student_id IS NOT NULL\n--     GROUP BY student_id\n-- )\n\n-- select * FROM student_avg_completion", "relation_name": "\"analytics\".\"public\".\"student_avg_completion\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-05-11T22:18:54.717754Z", "completed_at": "2025-05-11T22:18:54.734372Z"}, {"name": "execute", "started_at": "2025-05-11T22:18:54.774444Z", "completed_at": "2025-05-11T22:18:54.802670Z"}], "thread_id": "Thread-3", "execution_time": 0.10992932319641113, "adapter_response": {}, "message": "Database Error in model video_avg_completion (models/staging/video_avg_completion.sql)\n  syntax error at or near \")\"\n  LINE 17:   );\n             ^\n  compiled code at target/run/my_dbt_project/models/staging/video_avg_completion.sql", "failures": null, "unique_id": "model.my_dbt_project.video_avg_completion", "compiled": true, "compiled_code": "-- WITH video_avg_completion AS (\n--     SELECT\n--         video_title,\n--         AVG(completion_rate_percent) AS avg_completion_rate\n--     FROM \"analytics\".\"public\".\"lms_engagement_data\"\n--     WHERE video_title IS NOT NULL\n--     GROUP BY video_title\n-- )\n\n-- select * FROM video_avg_completion", "relation_name": "\"analytics\".\"public\".\"video_avg_completion\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-11T22:18:54.713965Z", "completed_at": "2025-05-11T22:18:54.722361Z"}, {"name": "execute", "started_at": "2025-05-11T22:18:54.722971Z", "completed_at": "2025-05-11T22:18:56.192638Z"}], "thread_id": "Thread-1", "execution_time": 1.4935634136199951, "adapter_response": {"_message": "SELECT 668471", "code": "SELECT", "rows_affected": 668471}, "message": "SELECT 668471", "failures": null, "unique_id": "model.my_dbt_project.raw_lms_data", "compiled": true, "compiled_code": "with raw_lms_data as (\n    select *\n    from \"analytics\".\"public\".\"lms_engagement_data\"\n)\nSELECT * FROM raw_lms_data", "relation_name": "\"analytics\".\"public\".\"raw_lms_data\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-11T22:18:56.210265Z", "completed_at": "2025-05-11T22:18:56.218044Z"}, {"name": "execute", "started_at": "2025-05-11T22:18:56.224715Z", "completed_at": "2025-05-11T22:18:56.384899Z"}], "thread_id": "Thread-3", "execution_time": 0.1842482089996338, "adapter_response": {"_message": "SELECT 40", "code": "SELECT", "rows_affected": 40}, "message": "SELECT 40", "failures": null, "unique_id": "model.my_dbt_project.ranked_videos_top_and_bottom_10_q3", "compiled": true, "compiled_code": "WITH video_avg_completion AS (\n    SELECT\n        video_title,\n        AVG(completion_rate_percent) AS avg_completion_rate\n    FROM \"analytics\".\"public\".\"raw_lms_data\"\n    WHERE video_title IS NOT NULL\n    GROUP BY video_title\n),\n\nranked_videos AS (\n    SELECT\n        video_title,\n        avg_completion_rate,\n        RANK() OVER (ORDER BY avg_completion_rate DESC) AS rank_desc,\n        RANK() OVER (ORDER BY avg_completion_rate ASC) AS rank_asc\n    FROM video_avg_completion\n)\n\nSELECT\n    video_title,\n    avg_completion_rate,\n    'Top' AS engagement_level\nFROM ranked_videos\nWHERE rank_desc <= 10\n\nUNION ALL\n\nSELECT\n    video_title,\n    avg_completion_rate,\n    'Bottom' AS engagement_level\nFROM ranked_videos\nWHERE rank_asc <= 10", "relation_name": "\"analytics\".\"public\".\"ranked_videos_top_and_bottom_10_q3\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-11T22:18:56.202719Z", "completed_at": "2025-05-11T22:18:56.217347Z"}, {"name": "execute", "started_at": "2025-05-11T22:18:56.218354Z", "completed_at": "2025-05-11T22:18:56.411515Z"}], "thread_id": "Thread-4", "execution_time": 0.2123117446899414, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": "SELECT 1", "failures": null, "unique_id": "model.my_dbt_project.learner_highest_completion_rate_q1", "compiled": true, "compiled_code": "WITH learner_highest_completion_rate AS (\n    select student_id,\n        count(video_title),\n        AVG(completion_rate_percent)\n    FROM \"analytics\".\"public\".\"raw_lms_data\"\n    group by student_id\n    ORDER BY count(video_title) desc\n)\nselect *\nFROM learner_highest_completion_rate\nLIMIT 1", "relation_name": "\"analytics\".\"public\".\"learner_highest_completion_rate_q1\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-11T22:18:56.206759Z", "completed_at": "2025-05-11T22:18:56.217706Z"}, {"name": "execute", "started_at": "2025-05-11T22:18:56.221723Z", "completed_at": "2025-05-11T22:18:56.419658Z"}], "thread_id": "Thread-2", "execution_time": 0.21936702728271484, "adapter_response": {"_message": "SELECT 150", "code": "SELECT", "rows_affected": 150}, "message": "SELECT 150", "failures": null, "unique_id": "model.my_dbt_project.ranked_students_top_and_bottom_10_q2", "compiled": true, "compiled_code": "WITH student_avg_completion AS (\n    SELECT\n        student_id,\n        AVG(completion_rate_percent) AS avg_completion_rate\n    FROM \"analytics\".\"public\".\"raw_lms_data\"\n    WHERE student_id IS NOT NULL\n    GROUP BY student_id\n),\n\nranked_students AS (\n    SELECT\n        student_id,\n        avg_completion_rate,\n        RANK() OVER (ORDER BY avg_completion_rate DESC) AS rank_desc,\n        RANK() OVER (ORDER BY avg_completion_rate ASC) AS rank_asc\n    FROM student_avg_completion\n)\n\nSELECT\n    student_id,\n    avg_completion_rate,\n    'Top' AS engagement_level\nFROM ranked_students\nWHERE rank_desc <= 10\n\nUNION ALL\n\nSELECT\n    student_id,\n    avg_completion_rate,\n    'Bottom' AS engagement_level\nFROM ranked_students\nWHERE rank_asc <= 10", "relation_name": "\"analytics\".\"public\".\"ranked_students_top_and_bottom_10_q2\"", "batch_results": null}], "elapsed_time": 1.9456472396850586, "args": {"static_parser": true, "select": [], "quiet": false, "vars": {}, "populate_cache": true, "macro_debugging": false, "profiles_dir": "/app/dbt", "partial_parse": true, "project_dir": "/app/dbt", "source_freshness_run_project_hooks": false, "indirect_selection": "eager", "empty": false, "log_level": "info", "show_resource_report": false, "strict_mode": false, "require_yaml_configuration_for_mf_time_spines": false, "introspect": true, "cache_selected_only": false, "write_json": true, "invocation_command": "dbt run", "log_level_file": "debug", "partial_parse_file_diff": true, "require_resource_names_without_spaces": false, "log_file_max_bytes": 10485760, "print": true, "use_colors_file": true, "send_anonymous_usage_stats": true, "require_batched_execution_for_custom_microbatch_strategy": false, "warn_error_options": {"include": [], "exclude": []}, "use_colors": true, "defer": false, "require_explicit_package_overrides_for_builtin_materializations": true, "require_nested_cumulative_type_params": false, "state_modified_compare_vars": false, "version_check": true, "state_modified_compare_more_unrendered_values": false, "exclude": [], "log_format_file": "debug", "which": "run", "log_path": "/app/dbt/logs", "skip_nodes_if_on_run_start_fails": false, "favor_state": false, "printer_width": 80, "log_format": "default"}}